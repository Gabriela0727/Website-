<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Solar System with Day/Night Cycles and Twinkling Stars</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128/examples/js/controls/OrbitControls.js"></script>
    <style>
      body {
        margin: 0;
        overflow: hidden;
        background: #000000;
        font-family: Arial, sans-serif;
        color: white;
      }
      canvas {
        display: block;
      }

      .info-panel {
        position: absolute;
        top: 20px;
        right: 20px;
        background: rgba(0, 0, 0, 0.85);
        padding: 20px;
        border-radius: 12px;
        border: 2px solid rgba(255, 255, 255, 0.1);
        max-width: 300px;
        backdrop-filter: blur(10px);
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
      }

      .info-panel:hover {
        border-color: rgba(255, 255, 255, 0.2);
        transform: translateY(-2px);
      }

      .info-panel h2 {
        margin: 0 0 15px;
        font-size: 24px;
        color: #ACE1AF;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        padding-bottom: 10px;
      }

      .info-panel .stats {
        display: grid;
        grid-template-columns: auto 1fr;
        gap: 8px 12px;
        margin-bottom: 15px;
      }

      .info-panel .label {
        color: #FFCCCC;
        font-size: 14px;
      }

      .info-panel .value {
        color: #CCCCFF;
        font-size: 14px;
        font-weight: 500;
      }

      .info-panel .description {
        font-size: 14px;
        line-height: 1.5;
        color: #FFCCCC;
        margin-top: 15px;
      }

      .info-panel .moons-list {
        margin-top: 15px;
        padding-top: 15px;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
      }

      .info-panel h3 {
        color: #ACE1AF;
        font-size: 18px;
        margin: 0 0 10px;
      }

      .info-panel .moon-item {
        font-size: 14px;
        color: #CCCCFF;
        margin: 5px 0;
        padding: 5px 10px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 4px;
        transition: background 0.2s ease;
      }

      .info-panel .moon-item:hover {
        background: rgba(255, 255, 255, 0.2);
      }

      .info-panel .additional-info {
        margin-top: 15px;
        padding-top: 15px;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        font-size: 13px;
        color: #FFCCCC;
      }
      .speed-control {
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(0, 0, 0, 0.85);
        padding: 15px 25px;
        border-radius: 12px;
        border: 2px solid rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        display: flex;
        align-items: center;
        gap: 15px;
        z-index: 1000;
      }

      .speed-control label {
        color: #ACE1AF;
        font-size: 14px;
      }

      .speed-control input[type="range"] {
        width: 200px;
        cursor: pointer;
      }

      .speed-control span {
        color: white;
        min-width: 40px;
      }

      #back-to-home {
        position: fixed;
        top: 20px;
        left: 20px;
        z-index: 1000;
      }

      .back-button {
        display: inline-block;
        padding: 12px 24px;
        background: linear-gradient(135deg, #4a90e2, #1e3a8a);
        color: #ffffff;
        font-family: 'Montserrat', sans-serif;
        font-size: 1rem;
        font-weight: 600;
        text-decoration: none;
        border-radius: 8px;
        border: 2px solid rgba(255, 255, 255, 0.2);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        transition: all 0.3s ease;
      }

      .back-button:hover {
        background: linear-gradient(135deg, #1e3a8a, #4a90e2);
        transform: translateY(-3px);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.5);
      }

      .back-button:active {
        transform: translateY(1px);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      }

      .homepage-button {
        margin-top: 2.5rem;
        padding: 14px 36px;
        background: rgba(74, 144, 226, 0.1);
        border: 1px solid rgba(74, 144, 226, 0.5);
        color: #fff;
        font-family: 'Montserrat', sans-serif;
        font-size: 1rem;
        font-weight: 500;
        letter-spacing: 1px;
        cursor: pointer;
        border-radius: 30px;
        position: relative;
        overflow: hidden;
        transition: all 0.4s ease;
        z-index: 5;
      }

      .homepage-button:hover {
        background: rgba(74, 144, 226, 0.3);
        box-shadow: 0 0 25px rgba(74, 144, 226, 0.6);
        transform: translateY(-2px);
      }

      .homepage-button::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: rgba(255, 255, 255, 0.1);
        transform: rotate(45deg);
        transition: all 0.5s ease;
        opacity: 0;
      }

      .homepage-button:hover::before {
        opacity: 1;
        animation: glowing 1.5s linear infinite;
      }
      /* Enhanced Audio Controls Styling */
.audio-control {
  position: fixed;
  bottom: 25px;
  right: 25px;
  z-index: 1000;
  transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.audio-control:hover {
  transform: scale(1.1);
}

.audio-control button {
  width: 54px;
  height: 54px;
  border-radius: 50%;
  background: rgba(15, 20, 40, 0.75);
  border: 2px solid rgba(100, 180, 255, 0.8);
  color: rgb(150, 220, 255);
  font-size: 26px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
  box-shadow: 0 0 15px rgba(100, 180, 255, 0.4);
  text-shadow: 0 0 10px rgba(150, 220, 255, 0.8);
  backdrop-filter: blur(4px);
}

.audio-control button:hover {
  background: rgba(20, 30, 60, 0.8);
  border-color: rgba(150, 220, 255, 0.9);
  box-shadow: 0 0 20px rgba(100, 180, 255, 0.6), 0 0 30px rgba(100, 180, 255, 0.3);
}

.audio-control button:active {
  transform: scale(0.95);
}

/* Volume Slider Styling */
.volume-control {
  position: fixed;
  bottom: 25px;
  right: 90px;
  z-index: 1000;
  display: flex;
  align-items: center;
  background: rgba(15, 20, 40, 0.75);
  padding: 10px 16px;
  border-radius: 30px;
  border: 2px solid rgba(100, 180, 255, 0.8);
  box-shadow: 0 0 15px rgba(100, 180, 255, 0.4);
  backdrop-filter: blur(4px);
  transition: opacity 0.3s ease, transform 0.3s ease;
}

.volume-control:hover {
  transform: translateX(-5px);
}

.volume-control label {
  color: rgb(200, 230, 255);
  margin-right: 12px;
  font-family: 'Arial', sans-serif;
  font-size: 14px;
  font-weight: 600;
  text-shadow: 0 0 8px rgba(150, 220, 255, 0.6);
  letter-spacing: 0.5px;
}

.volume-control input[type="range"] {
  -webkit-appearance: none;
  width: 120px;
  height: 6px;
  background: linear-gradient(to right, rgba(100, 180, 255, 0.9), rgba(150, 220, 255, 0.6));
  border-radius: 10px;
  outline: none;
  box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.3);
}

.volume-control input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: rgb(220, 240, 255);
  cursor: pointer;
  box-shadow: 0 0 10px rgba(100, 180, 255, 0.8);
  border: 2px solid rgba(100, 180, 255, 0.9);
  transition: all 0.2s ease;
}

.volume-control input[type="range"]::-webkit-slider-thumb:hover {
  background: white;
  transform: scale(1.1);
}

.volume-control input[type="range"]::-moz-range-thumb {
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: rgb(220, 240, 255);
  cursor: pointer;
  box-shadow: 0 0 10px rgba(100, 180, 255, 0.8);
  border: 2px solid rgba(100, 180, 255, 0.9);
  transition: all 0.2s ease;
}

.volume-control input[type="range"]::-moz-range-thumb:hover {
  background: white;
  transform: scale(1.1);
}

/* Animation for audio visualization */
@keyframes pulse {
  0% { transform: scale(1); opacity: 0.7; }
  50% { transform: scale(1.05); opacity: 1; }
  100% { transform: scale(1); opacity: 0.7; }
}

@keyframes orbit {
  0% { transform: rotate(0deg) translateX(8px) rotate(0deg); }
  100% { transform: rotate(360deg) translateX(8px) rotate(-360deg); }
}

/* Animated sound wave effect */
.audio-control button::before {
  content: '';
  position: absolute;
  width: 70px;
  height: 70px;
  border-radius: 50%;
  border: 2px solid rgba(100, 180, 255, 0.3);
  animation: pulse 3s infinite ease-in-out;
  pointer-events: none;
}

.audio-control button::after {
  content: '';
  position: absolute;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background-color: rgba(150, 220, 255, 0.8);
  animation: orbit 3s infinite linear;
  pointer-events: none;
}

/* Show volume control on hover for cleaner UI */
.volume-control {
  opacity: 0.7;
  transform: translateX(10px);
}

.audio-control:hover + .volume-control,
.volume-control:hover {
  opacity: 1;
  transform: translateX(0);
}

/* Responsive adjustments */
@media screen and (max-width: 768px) {
  .audio-control {
    bottom: 20px;
    right: 20px;
  }
  
  .audio-control button {
    width: 46px;
    height: 46px;
    font-size: 22px;
  }
  
  .volume-control {
    bottom: 20px;
    right: 75px;
    padding: 8px 12px;
  }
  
  .volume-control input[type="range"] {
    width: 90px;
  }
}

/* For small devices */
@media screen and (max-width: 480px) {
  .audio-control {
    bottom: 15px;
    right: 15px;
  }
  
  .audio-control button {
    width: 40px;
    height: 40px;
    font-size: 18px;
  }
  
  .volume-control {
    bottom: 15px;
    right: 65px;
    padding: 6px 10px;
  }
  
  .volume-control label {
    font-size: 12px;
  }
  
  .volume-control input[type="range"] {
    width: 70px;
  }
}
    </style>
  </head>
  <body>
    <div class="info-panel" id="infoPanel">
      <h2>Celestial Info</h2>
      <p>Hover over a planet, moon, or asteroid to see details here.</p>
    </div>
    <div class="speed-control">
      <label for="speedSlider">Animation Speed</label>
      <input
        type="range"
        id="speedSlider"
        min="0.1"
        max="5"
        step="0.1"
        value="1"
      />
      <span id="speedValue">1x</span>
    </div>
    <div id="back-to-home">
      <button class="homepage-button" onclick="goToHome()">← Back to Homepage</button>
    </div>
    <script>
      const scene = new THREE.Scene();
      const camera = new THREE.PerspectiveCamera(
        45,
        window.innerWidth / window.innerHeight,
        0.1,
        10000
      );
      let speedMultiplier = 1;
      // slider elements
      const speedSlider = document.getElementById("speedSlider");
      const speedValue = document.getElementById("speedValue");

      // updates speed when slider changes
      speedSlider.addEventListener("input", (event) => {
        speedMultiplier = parseFloat(event.target.value);
        speedValue.textContent = `${speedMultiplier.toFixed(1)}x`;
      });
      const renderer = new THREE.WebGLRenderer({ antialias: true });
      renderer.setSize(window.innerWidth, window.innerHeight);
      renderer.setClearColor(0x000000);
      document.body.appendChild(renderer.domElement);

      const controls = new THREE.OrbitControls(camera, renderer.domElement);
      controls.enableDamping = true;
      controls.dampingFactor = 0.05;

      camera.position.set(0, 50, 150);
      camera.lookAt(scene.position);

      const sunLight = new THREE.PointLight(0xffffff, 1.5, 1000);
      sunLight.position.set(0, 0, 0);
      scene.add(sunLight);

      const ambientLight = new THREE.AmbientLight(0x404040, 0.5);
      scene.add(ambientLight);

      let backgroundMusic;
      let audioContext;
      let audioListener;
      let soundEffects = {};
      let currentlyHovering = false;

      function createStars() {
        const starGeometry = new THREE.BufferGeometry();
        const starCount = 70000;
        const starVertices = [];
        const starOpacities = new Float32Array(starCount);
        const starTwinkleSpeed = new Float32Array(starCount);

        for (let i = 0; i < starCount; i++) {
          const x = (Math.random() - 0.5) * 4000;
          const y = (Math.random() - 0.5) * 4000;
          const z = (Math.random() - 0.5) * 4000;
          starVertices.push(x, y, z);

          starOpacities[i] = Math.random();
          starTwinkleSpeed[i] = 0.3 + Math.random() * 0.5;
        }

        starGeometry.setAttribute(
          "position",
          new THREE.Float32BufferAttribute(starVertices, 3)
        );
        starGeometry.setAttribute(
          "opacity",
          new THREE.Float32BufferAttribute(starOpacities, 1)
        );
        starGeometry.setAttribute(
          "twinkleSpeed",
          new THREE.Float32BufferAttribute(starTwinkleSpeed, 1)
        );

        const starMaterial = new THREE.PointsMaterial({
          color: 0xffffff,
          size: 1,
          transparent: true,
          opacity: 1,
          vertexColors: false,
        });

        const stars = new THREE.Points(starGeometry, starMaterial);
        stars.userData.opacities = starOpacities;
        stars.userData.twinkleSpeeds = starTwinkleSpeed;
        scene.add(stars);
        return stars;
      }

      const stars = createStars();

      function createSunGlow(size, opacity, color) {
        const glowMaterial = new THREE.MeshBasicMaterial({
          color: color,
          transparent: true,
          opacity: opacity,
        });
        const glowGeometry = new THREE.SphereGeometry(size, 32, 32);
        return new THREE.Mesh(glowGeometry, glowMaterial);
      }
      function createGalaxy(params = {}) {
        const {
          particles = 50000,
          radius = 1000,
          branches = 5,
          spin = 1,
          randomness = 0.2,
          randomnessPower = 3,
          insideColor = "#ff6030",
          outsideColor = "#1b3984",
          size = 0.01,
        } = params;

        // creates buffer geometry
        const geometry = new THREE.BufferGeometry();
        const positions = new Float32Array(particles * 3);
        const colors = new Float32Array(particles * 3);

        const colorInside = new THREE.Color(insideColor);
        const colorOutside = new THREE.Color(outsideColor);

        for (let i = 0; i < particles; i++) {
          const i3 = i * 3;

          //position calculation
          const branchAngle = ((i % branches) / branches) * Math.PI * 2;
          const radiusPosition = Math.random() * radius;
          const spinAngle = radiusPosition * spin;

          // adds randomness to position
          const randomX =
            Math.pow(Math.random(), randomnessPower) *
            (Math.random() < 0.5 ? 1 : -1) *
            randomness *
            radiusPosition;
          const randomY =
            Math.pow(Math.random(), randomnessPower) *
            (Math.random() < 0.5 ? 1 : -1) *
            randomness *
            radiusPosition;
          const randomZ =
            Math.pow(Math.random(), randomnessPower) *
            (Math.random() < 0.5 ? 1 : -1) *
            randomness *
            radiusPosition;

          // sets positions
          positions[i3] =
            Math.cos(branchAngle + spinAngle) * radiusPosition + randomX;
          positions[i3 + 1] = randomY;
          positions[i3 + 2] =
            Math.sin(branchAngle + spinAngle) * radiusPosition + randomZ;

          // color gradient
          const mixColor = colorInside.clone();
          mixColor.lerp(colorOutside, radiusPosition / radius);

          colors[i3] = mixColor.r;
          colors[i3 + 1] = mixColor.g;
          colors[i3 + 2] = mixColor.b;
        }

        geometry.setAttribute(
          "position",
          new THREE.BufferAttribute(positions, 3)
        );
        geometry.setAttribute("color", new THREE.BufferAttribute(colors, 3));

      
        const material = new THREE.PointsMaterial({
          size,
          sizeAttenuation: true,
          depthWrite: false,
          blending: THREE.AdditiveBlending,
          vertexColors: true,
          transparent: true,
          opacity: 0.5,
        });

        const galaxy = new THREE.Points(geometry, material);

        // adds rotation data
        galaxy.userData.rotationSpeed = 0.0001 + Math.random() * 0.0001;

        return galaxy;
      }

      // creates and position galaxies
      const galaxies = [
        {
          params: {
            particles: 50000,
            radius: 1000,
            branches: 5,
            spin: 1,
            randomness: 0.2,
            randomnessPower: 3,
            insideColor: "#ff6030",
            outsideColor: "#1b3984",
            size: 0.3,
            position: new THREE.Vector3(1000, 500, -1500),
          },
        },
        {
          params: {
            particles: 40000,
            radius: 800,
            branches: 3,
            spin: -1.5,
            randomness: 0.3,
            randomnessPower: 2,
            insideColor: "#1b3984",
            outsideColor: "#ff6030",
            size: 0.08,
            position: new THREE.Vector3(-1500, -500, -1000),
          },
        },
        {
          params: {
            particles: 30000,
            radius: 600,
            branches: 4,
            spin: 2,
            randomness: 0.2,
            randomnessPower: 4,
            insideColor: "#ff8060",
            outsideColor: "#2b4994",
            size: 0.12,
            position: new THREE.Vector3(-1250, 1000, -500),
          },
        },
      ].map(({ params }) => {
        const galaxy = createGalaxy(params);
        galaxy.position.copy(params.position);
        galaxy.rotation.x = Math.random() * Math.PI;
        galaxy.rotation.y = Math.random() * Math.PI;
        scene.add(galaxy);
        return galaxy;
      });

      function createSunCorona() {
        const points = [];
        const coronaSegments = 32;
        for (let i = 0; i < coronaSegments; i++) {
          const angle = (i / coronaSegments) * Math.PI * 2;
          const radius = 12 + Math.random() * 4;
          points.push(
            new THREE.Vector2(
              Math.cos(angle) * radius,
              Math.sin(angle) * radius
            )
          );
        }
        points.push(points[0]);

        const coronaGeometry = new THREE.LatheGeometry(points, 32);
        const coronaMaterial = new THREE.MeshBasicMaterial({
          color: 0xff7700,
          transparent: true,
          opacity: 0.3,
          side: THREE.DoubleSide,
        });
        return new THREE.Mesh(coronaGeometry, coronaMaterial);
      }

      const sunGeometry = new THREE.SphereGeometry(8, 64, 64);
      const sunMaterial = new THREE.MeshStandardMaterial({
        emissive: 0xffaa00,
        emissiveIntensity: 1,
        roughness: 0.2,
        metalness: 0,
      });
      const sun = new THREE.Mesh(sunGeometry, sunMaterial);
      scene.add(sun);

      const glow1 = createSunGlow(9, 0.5, 0xffaa00);
      const glow2 = createSunGlow(10, 0.3, 0xffdd00);
      const glow3 = createSunGlow(11, 0.1, 0xffff00);
      scene.add(glow1);
      scene.add(glow2);
      scene.add(glow3);

      const corona = createSunCorona();
      scene.add(corona);

      const planetData = [
        {
          name: "Mercury",
          size: 2,
          color: 0xaaaaaa,
          distance: 20,
          speed: 0.02,
          texture:
            "https://cdn.glitch.global/bc88ebd6-ae9a-43e7-963f-45a604480200/8k_mercury.jpg?v=1739218972511",
          atmosphereColor: 0xaaaaaa,
          moons: [],
        },
        {
          name: "Venus",
          size: 3,
          color: 0xffcc99,
          distance: 30,
          speed: 0.015,
          texture:
            "https://cdn.glitch.global/bc88ebd6-ae9a-43e7-963f-45a604480200/4k_venus_atmosphere.jpg?v=1739218936369",
          atmosphereColor: 0xffcc99,
          moons: [],
        },
        {
          name: "Earth",
          size: 4,
          color: 0x4444ff,
          distance: 40,
          speed: 0.01,
          texture:
            "https://cdn.glitch.global/bc88ebd6-ae9a-43e7-963f-45a604480200/8k_earth_daymap.jpg?v=1739218943949",
          atmosphereColor: 0x4444ff,
          moons: [
            {
              name: "Moon",
              size: 1,
              distance: 6,
              speed: 0.05,
              color: 0xaaaaaa,
            },
          ],
        },
        {
          name: "Mars",
          size: 3.5,
          color: 0xff4444,
          distance: 50,
          speed: 0.008,
          texture:
            "https://cdn.glitch.global/bc88ebd6-ae9a-43e7-963f-45a604480200/8k_mars.jpg?v=1739218965450",
          atmosphereColor: 0xff4444,
          moons: [
            {
              name: "Phobos",
              size: 0.7,
              distance: 5,
              speed: 0.07,
              color: 0x888888,
            },
            {
              name: "Deimos",
              size: 0.5,
              distance: 8,
              speed: 0.04,
              color: 0x999999,
            },
          ],
        },
        {
          name: "Jupiter",
          size: 8,
          color: 0xffaa88,
          distance: 70,
          speed: 0.004,
          texture:
            "https://cdn.glitch.global/bc88ebd6-ae9a-43e7-963f-45a604480200/8k_jupiter.jpg?v=1739218954364",
          atmosphereColor: 0xffaa88,
          moons: [
            {
              name: "Io",
              size: 1.2,
              distance: 10,
              speed: 0.06,
              color: 0xffcc88,
            },
            {
              name: "Europa",
              size: 1,
              distance: 14,
              speed: 0.05,
              color: 0xbbbbbb,
            },
            {
              name: "Ganymede",
              size: 1.5,
              distance: 18,
              speed: 0.03,
              color: 0xdddddd,
            },
            {
              name: "Callisto",
              size: 1.4,
              distance: 22,
              speed: 0.02,
              color: 0xcccccc,
            },
          ],
        },
        {
          name: "Saturn",
          size: 7,
          color: 0xffdd99,
          distance: 90,
          speed: 0.003,
          texture:
            "https://cdn.glitch.global/bc88ebd6-ae9a-43e7-963f-45a604480200/8k_saturn.jpg?v=1739219290213",
          atmosphereColor: 0xffdd99,
          moons: [],
        },
        {
          name: "Uranus",
          size: 6,
          color: 0x66ccff,
          distance: 110,
          speed: 0.002,
          texture:
            "https://cdn.glitch.global/bc88ebd6-ae9a-43e7-963f-45a604480200/2k_uranus.jpg?v=1739218939048",
          atmosphereColor: 0x66ccff,
          moons: [],
        },
        {
          name: "Neptune",
          size: 6,
          color: 0x3366ff,
          distance: 130,
          speed: 0.0015,
          texture:
            "https://cdn.glitch.global/bc88ebd6-ae9a-43e7-963f-45a604480200/2k_neptune.jpg?v=1739218930401",
          atmosphereColor: 0x3366ff,
          moons: [],
        },
      ];

      const raycaster = new THREE.Raycaster();
      const mouse = new THREE.Vector2();
      const infoPanel = document.getElementById("infoPanel");

      function loadTexture(url) {
        const textureLoader = new THREE.TextureLoader();
        return new Promise((resolve, reject) => {
          textureLoader.load(
            url,
            (texture) => resolve(texture),
            undefined,
            (error) => reject(error)
          );
        });
      }

      function createPlanetMaterial(color, textureUrl) {
        if (textureUrl) {
          const material = new THREE.MeshPhongMaterial({
            map: null, // will set when texture loads
            bumpScale: 0.05,
            specular: new THREE.Color("grey"),
            shininess: 10,
          });

          // load and place the texture
          loadTexture(textureUrl)
            .then((texture) => {
              material.map = texture;
              material.needsUpdate = true;
            })
            .catch((error) => {
              console.error("Error loading texture:", error);
              // fall back to basic material if texture doesn't load
              material.color = new THREE.Color(color);
            });

          return { dayTexture: material, nightTexture: material };
        }

        // fall back to basic materials if no texture URL is placed
        const dayTexture = new THREE.MeshStandardMaterial({
          color: color,
          roughness: 0.7,
          metalness: 0.3,
        });

        const nightTexture = new THREE.MeshStandardMaterial({
          color: new THREE.Color(color).multiplyScalar(0.2),
          roughness: 0.9,
          metalness: 0.1,
          emissive: new THREE.Color(color).multiplyScalar(0.1),
        });

        return { dayTexture, nightTexture };
      }

      const planets = planetData.map((data) => {
        const planetGroup = new THREE.Group();
        const { dayTexture, nightTexture } = createPlanetMaterial(
          data.color,
          data.texture
        );

        const geometry = new THREE.SphereGeometry(data.size, 32, 32);
        const planet = new THREE.Mesh(geometry, dayTexture);
        planet.name = data.name;

        planet.userData.rotationSpeed = 0.01 + Math.random() * 0.01;
        planet.userData.axialTilt = (Math.random() - 0.5) * 0.5;

        const atmosphereGeometry = new THREE.SphereGeometry(
          data.size * 1.1,
          32,
          32
        );
        const atmosphereMaterial = new THREE.MeshBasicMaterial({
          color: data.atmosphereColor,
          transparent: true,
          opacity: 0.3,
        });
        const atmosphere = new THREE.Mesh(
          atmosphereGeometry,
          atmosphereMaterial
        );

        const orbitGeometry = new THREE.RingGeometry(
          data.distance - 0.05,
          data.distance + 0.05,
          64
        );
        const orbitMaterial = new THREE.MeshBasicMaterial({
          color: 0xffffff,
          side: THREE.DoubleSide,
          transparent: true,
          opacity: 0.3,
        });
        const orbit = new THREE.Mesh(orbitGeometry, orbitMaterial);
        orbit.rotation.x = Math.PI / 2;
        scene.add(orbit);

        planetGroup.add(planet);
        planetGroup.add(atmosphere);

        const moons = (data.moons || []).map((moonData) => {
          const moonGroup = new THREE.Group();
          const moonGeometry = new THREE.SphereGeometry(moonData.size, 16, 16);
          const moonMaterial = new THREE.MeshStandardMaterial({
            color: moonData.color,
          });
          const moon = new THREE.Mesh(moonGeometry, moonMaterial);
          moon.name = moonData.name;
          moonGroup.add(moon);

          const moonOrbitGeometry = new THREE.RingGeometry(
            moonData.distance - 0.1,
            moonData.distance + 0.1,
            32
          );
          const moonOrbitMaterial = new THREE.MeshBasicMaterial({
            color: 0xffffff,
            side: THREE.DoubleSide,
            transparent: true,
            opacity: 0.2,
          });
          const moonOrbit = new THREE.Mesh(
            moonOrbitGeometry,
            moonOrbitMaterial
          );
          moonOrbit.rotation.x = Math.PI / 2;
          planetGroup.add(moonOrbit);

          moonGroup.userData = {
            ...moonData,
            angle: Math.random() * Math.PI * 2,
          };
          planetGroup.add(moonGroup);
          return moonGroup;
        });

        planetGroup.userData = {
          ...data,
          angle: Math.random() * Math.PI * 2,
          moons,
          dayMaterial: dayTexture,
          nightMaterial: nightTexture,
        };

        return planetGroup;
      });

      planets.forEach((planet) => scene.add(planet));

      function createComet() {
        const cometGroup = new THREE.Group();

        // creates comet nucleus
        const cometGeometry = new THREE.SphereGeometry(1, 32, 32);
        const cometMaterial = new THREE.MeshPhongMaterial({
          color: 0xcccccc,
          emissive: 0x444444,
        });
        const comet = new THREE.Mesh(cometGeometry, cometMaterial);

        // create comet tail
        const tailGeometry = new THREE.ConeGeometry(2, 20, 32);
        const tailMaterial = new THREE.MeshBasicMaterial({
          color: 0x88ccff,
          transparent: true,
          opacity: 0.3,
        });
        const tail = new THREE.Mesh(tailGeometry, tailMaterial);
        tail.position.z = -10;
        tail.rotation.x = Math.PI / 2;

        cometGroup.add(comet);
        cometGroup.add(tail);

        // set initial position and properties
        const angle = Math.random() * Math.PI * 2;
        const distance = 150 + Math.random() * 50;
        cometGroup.position.x = Math.cos(angle) * distance;
        cometGroup.position.z = Math.sin(angle) * distance;
        cometGroup.position.y = (Math.random() - 0.5) * 50;

        cometGroup.userData = {
          angle: angle,
          distance: distance,
          speed: 0.001 + Math.random() * 0.002,
          inclination: (Math.random() * Math.PI) / 4,
        };

        scene.add(cometGroup);
        return cometGroup;
      }

      function createEnhancedAsteroidBelt() {
        const asteroidBelt = new THREE.Group();
        const asteroidCount = 1000;

        // creates a couple of asteroid geometries for variety
        const geometries = [
          new THREE.DodecahedronGeometry(0.3),
          new THREE.DodecahedronGeometry(0.5),
          new THREE.DodecahedronGeometry(0.7),
          new THREE.IcosahedronGeometry(0.4),
          new THREE.TetrahedronGeometry(0.4),
        ];

        const materials = [
          new THREE.MeshStandardMaterial({ color: 0x888888, roughness: 0.8 }),
          new THREE.MeshStandardMaterial({ color: 0x777777, roughness: 0.7 }),
          new THREE.MeshStandardMaterial({ color: 0x666666, roughness: 0.9 }),
        ];

        for (let i = 0; i < asteroidCount; i++) {
          const geometry =
            geometries[Math.floor(Math.random() * geometries.length)];
          const material =
            materials[Math.floor(Math.random() * materials.length)];
          const asteroid = new THREE.Mesh(geometry, material);

          // position
          const angle = Math.random() * Math.PI * 2;
          const distance = 55 + Math.random() * 15; // Between Mars and Jupiter
          const height = (Math.random() - 0.5) * 5;

          asteroid.position.x = Math.cos(angle) * distance;
          asteroid.position.z = Math.sin(angle) * distance;
          asteroid.position.y = height;

          // random rotation
          asteroid.rotation.x = Math.random() * Math.PI;
          asteroid.rotation.y = Math.random() * Math.PI;
          asteroid.rotation.z = Math.random() * Math.PI;

          // adds orbital properties
          asteroid.userData = {
            angle: angle,
            distance: distance,
            rotationSpeed: Math.random() * 0.02,
            orbitSpeed: 0.001 + Math.random() * 0.002,
          };

          asteroidBelt.add(asteroid);
        }

        scene.add(asteroidBelt);
        return asteroidBelt;
      }

      const comets = Array(3)
        .fill(null)
        .map(() => createComet());
      const asteroidBelt = createEnhancedAsteroidBelt();

      function animate() {
        requestAnimationFrame(animate);

        // animates stars twinkling
        const time = Date.now() * 0.001;
        const opacities = stars.userData.opacities;
        const twinkleSpeeds = stars.userData.twinkleSpeeds;

        for (let i = 0; i < opacities.length; i++) {
          opacities[i] = 0.5 + Math.sin(time * twinkleSpeeds[i]) * 0.5;
        }
        stars.geometry.attributes.opacity.needsUpdate = true;
        stars.material.opacity = 1;

        // animates sun
        sun.rotation.y += 0.001 * speedMultiplier;

        // animates sun intensity
        const pulseIntensity = 1 + Math.sin(time) * 0.2;
        sunLight.intensity = 2 * pulseIntensity;
        sunMaterial.emissiveIntensity = pulseIntensity;

        // animates glow layers
        glow1.scale.set(
          1 + Math.sin(time * 1.1) * 0.04,
          1 + Math.sin(time * 1.1) * 0.04,
          1 + Math.sin(time * 1.1) * 0.04
        );
        glow2.scale.set(
          1 + Math.sin(time * 0.8) * 0.06,
          1 + Math.sin(time * 0.8) * 0.06,
          1 + Math.sin(time * 0.8) * 0.06
        );
        glow3.scale.set(
          1 + Math.sin(time * 0.6) * 0.08,
          1 + Math.sin(time * 0.6) * 0.08,
          1 + Math.sin(time * 0.6) * 0.08
        );

        // rotates corona
        corona.rotation.y += 0.0005 * speedMultiplier;
        corona.rotation.x = Math.sin(time * 0.3) * 0.1;

        // animates planets
        planets.forEach((planetGroup) => {
          const data = planetGroup.userData;
          // orbital movement
          data.angle += data.speed * speedMultiplier;
          planetGroup.position.x = Math.cos(data.angle) * data.distance;
          planetGroup.position.z = Math.sin(data.angle) * data.distance;

          // planet rotation and day/night cycle
          const planet = planetGroup.children[0];
          planet.rotation.y += planet.userData.rotationSpeed * speedMultiplier;

          // angle to sun for day/night effect
          const angleToSun = Math.atan2(
            planetGroup.position.z,
            planetGroup.position.x
          );

          // update material based on angle to sun
          const sunFacing = (Math.cos(angleToSun - planet.rotation.y) + 1) / 2;
          planet.material.color.lerpColors(
            new THREE.Color(data.nightMaterial.color),
            new THREE.Color(data.dayMaterial.color),
            sunFacing
          );

          // animates moons
          data.moons?.forEach((moon) => {
            const moonData = moon.userData;
            moonData.angle += moonData.speed * speedMultiplier;
            moon.position.x = Math.cos(moonData.angle) * moonData.distance;
            moon.position.z = Math.sin(moonData.angle) * moonData.distance;

            // adds rotation to moons
            const moonMesh = moon.children[0];
            moonMesh.rotation.y += 0.005 * speedMultiplier;
          });
        });
        comets.forEach((cometGroup) => {
          const data = cometGroup.userData;
          data.angle += data.speed * speedMultiplier;

          // updates position
          cometGroup.position.x = Math.cos(data.angle) * data.distance;
          cometGroup.position.z = Math.sin(data.angle) * data.distance;
          cometGroup.position.y = Math.sin(data.angle + data.inclination) * 50;

          // orients tail away from sun
          cometGroup.lookAt(0, 0, 0);
          cometGroup.rotateY(Math.PI);
        });

        // animates asteroid
        asteroidBelt.children.forEach((asteroid) => {
          const data = asteroid.userData;
          data.angle += data.orbitSpeed * speedMultiplier;

          // updates position
          asteroid.position.x = Math.cos(data.angle) * data.distance;
          asteroid.position.z = Math.sin(data.angle) * data.distance;

          // rotates asteroid
          asteroid.rotation.x += data.rotationSpeed * speedMultiplier;
          asteroid.rotation.y += data.rotationSpeed * speedMultiplier;
        });

        galaxies.forEach((galaxy) => {
          galaxy.rotation.y += galaxy.userData.rotationSpeed * speedMultiplier;
        });

        controls.update();
        renderer.render(scene, camera);
      }
      function getRandomFact(objectName) {
        const facts = {
          Mercury: [
            "Closest planet to the Sun",
            "Smallest planet in our solar system",
            "Has no moons",
          ],
          Venus: [
            "Hottest planet in our solar system",
            "Rotates backwards compared to most planets",
            "Often called Earth's sister planet",
          ],
          Earth: [
            "Only known planet with life",
            "Has one natural satellite - the Moon",
            "71% of surface covered by water",
          ],
          Mars: [
            "Known as the Red Planet",
            "Has the largest volcano in the solar system",
            "Home to Olympus Mons",
          ],
          Jupiter: [
            "Largest planet in our solar system",
            "Has the Great Red Spot storm",
            "Has at least 79 moons",
          ],
          Saturn: [
            "Famous for its spectacular ring system",
            "Least dense planet in the solar system",
            "Has 82 confirmed moons",
          ],
          Uranus: [
            "Rotates on its side",
            "First planet discovered using a telescope",
            "Has 27 known moons",
          ],
          Neptune: [
            "The windiest planet",
            "Last planet in our solar system",
            "Has 14 known moons",
          ],
        };
        return facts[objectName]
          ? facts[objectName][
              Math.floor(Math.random() * facts[objectName].length)
            ]
          : null;
      }

      function formatDistance(distance) {
        return `${distance.toFixed(1)} AU`;
      }

      function formatSpeed(speed) {
        return `${(speed * 100).toFixed(2)} km/s`;
      }

      function onMouseMove(event) {
        mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
        mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

        raycaster.setFromCamera(mouse, camera);

        const allObjects = [];
        scene.traverse((object) => {
          if (object instanceof THREE.Mesh && object.name) {
            allObjects.push(object);
          }
        });

        const intersects = raycaster.intersectObjects(allObjects, false);

        if (intersects.length > 0) {
          if (!currentlyHovering && soundEffects.planetHover) {
            soundEffects.planetHover.currentTime = 0;
            soundEffects.planetHover.play();
            currentlyHovering = true;
          }
        } else {
          currentlyHovering = false;
        }

        if (intersects.length > 0) {
          const object = intersects[0].object;
          let parentGroup = object.parent;

          while (parentGroup && !parentGroup.userData.distance) {
            parentGroup = parentGroup.parent;
          }

          const data = parentGroup ? parentGroup.userData : {};
          const isMoon =
            object.parent.userData.distance !== undefined &&
            parentGroup &&
            parentGroup.userData.name !== object.name;

          let infoHTML = `<h2>${object.name}</h2><div class="stats">`;

          if (isMoon) {
            const parentName = parentGroup.userData.name;
            infoHTML += `
            <span class="label">Classification:</span>
            <span class="value">Natural Satellite</span>
            <span class="label">Parent Planet:</span>
            <span class="value">${parentName}</span>
            <span class="label">Orbital Distance:</span>
            <span class="value">${formatDistance(
              object.parent.userData.distance
            )}</span>
            <span class="label">Orbital Speed:</span>
            <span class="value">${formatSpeed(
              object.parent.userData.speed
            )}</span>
            <span class="label">Diameter:</span>
            <span class="value">${(
              object.geometry.parameters.radius * 2
            ).toFixed(1)} km</span>
            <span class="label">Surface Gravity:</span>
            <span class="value">${(
              object.geometry.parameters.radius * 0.5
            ).toFixed(2)} m/s²</span>
          </div>
          <div class="additional-info">
            <p>This moon is in a stable orbit around ${parentName}. Click and drag to explore its orbital path.</p>
          </div>`;
          } else if (data.distance) {
            const fact = getRandomFact(object.name);
            infoHTML += `
            <span class="label">Classification:</span>
            <span class="value">Planet</span>
            <span class="label">Distance from Sun:</span>
            <span class="value">${formatDistance(data.distance)}</span>
            <span class="label">Orbital Speed:</span>
            <span class="value">${formatSpeed(data.speed)}</span>
            <span class="label">Diameter:</span>
            <span class="value">${(
              object.geometry.parameters.radius * 2
            ).toFixed(1)} km</span>
            <span class="label">Rotation Period:</span>
            <span class="value">${(24 / object.userData.rotationSpeed).toFixed(
              1
            )} hours</span>
            <span class="label">Surface Temperature:</span>
            <span class="value">${Math.round(300 - data.distance * 2)}°C</span>
          </div>`;

            if (fact) {
              infoHTML += `
            <div class="additional-info">
              <p>Did you know? ${fact}</p>
            </div>`;
            }

            if (data.moons && data.moons.length > 0) {
              infoHTML += `
            <div class="moons-list">
              <h3>Moons (${data.moons.length})</h3>
              ${data.moons
                .map(
                  (moon) => `
                <div class="moon-item">
                  • ${moon.children[0].name}
                </div>
              `
                )
                .join("")}
            </div>`;
            }
          }

          infoPanel.innerHTML = infoHTML;
        } else {
          infoPanel.innerHTML = `
          <h2>Solar System Explorer</h2>
          <div class="description">
            <p>Hover over any planet or moon to discover detailed information about its properties,
            orbital characteristics, and satellite system.</p>
            <p>Click and drag to rotate the view. Scroll to zoom in/out.</p>
          </div>`;
        }
      }

      window.addEventListener("mousemove", onMouseMove);

      renderer.domElement.addEventListener('click', () => {
        raycaster.setFromCamera(mouse, camera);
        const allObjects = [];
        scene.traverse((object) => {
          if (object instanceof THREE.Mesh && object.name) {
            allObjects.push(object);
          }
        });

        const intersects = raycaster.intersectObjects(allObjects, false);
        if (intersects.length > 0 && soundEffects.planetClick) {
          soundEffects.planetClick.currentTime = 0;
          soundEffects.planetClick.play();
        }
      });

      window.addEventListener("resize", () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
      });

      initAudioSystem();
      animate();

      function initAudioSystem() {
        // Create and configure audio elements
        backgroundMusic = new Audio('https://cdn.glitch.global/7db54938-5509-4084-8349-d3d37e5ae310/466478__tri-tachyon__jazzy-vibes-36-loop-smooth-jazz.mp3?v=1745424439777');
        backgroundMusic.loop = true;
        backgroundMusic.volume = 0.3;

        // Initialize sound effects
        soundEffects = {
          planetHover: new Audio('https://cdn.glitch.global/7db54938-5509-4084-8349-d3d37e5ae310/150879__nenadsimic__jazzy-chords.wav?v=1745423883455'),
          planetClick: new Audio('https://cdn.glitch.global/7db54938-5509-4084-8349-d3d37e5ae310/715598__setuniman__lets-go-1v25.wav?v=1745424125574'),
          cometPass: new Audio('https://cdn.glitch.global/7db54938-5509-4084-8349-d3d37e5ae310/571367__szegvari__jazzpiano1ms.wav?v=1745424737726')
        };

        // Set initial volume for all sound effects
        Object.values(soundEffects).forEach(sound => {
          sound.volume = 0.4;
        });

        // Create audio controls UI
        createAudioControls();

        // Initialize THREE.js audio system
        audioListener = new THREE.AudioListener();
        camera.add(audioListener);

        // Setup advanced audio processing
        setupAdvancedAudio();

        // Add positional audio to planets
        addPositionalAudioToPlanets();
      }

      function createAudioControls() {
        // Create audio toggle button
        const audioControlDiv = document.createElement('div');
        audioControlDiv.classList.add('audio-control');
        audioControlDiv.innerHTML = `
          <button id="toggleAudio">
            <span id="audioIcon">🔊</span>
          </button>
        `;
        document.body.appendChild(audioControlDiv);
      
        // Create volume slider
        const volumeControlDiv = document.createElement('div');
        volumeControlDiv.classList.add('volume-control');
        volumeControlDiv.innerHTML = `
          <label for="volumeSlider">Volume</label>
          <input type="range" id="volumeSlider" min="0" max="1" step="0.1" value="0.3">
        `;
        document.body.appendChild(volumeControlDiv);
      
        // Add event listeners after DOM is fully loaded
        document.addEventListener('DOMContentLoaded', () => {
          const toggleAudio = document.getElementById('toggleAudio');
          toggleAudio.addEventListener('click', () => {
            if (backgroundMusic.paused) {
              backgroundMusic.play();
              document.getElementById('audioIcon').textContent = '🔊';
            } else {
              backgroundMusic.pause();
              document.getElementById('audioIcon').textContent = '🔇';
            }
          });
      
          const volumeSlider = document.getElementById('volumeSlider');
          volumeSlider.addEventListener('input', (event) => {
            const volume = parseFloat(event.target.value);
            backgroundMusic.volume = volume;
            Object.values(soundEffects).forEach(sound => {
              sound.volume = volume;
            });
          });
        });
      }

      function setupAdvancedAudio() {
        try {
          audioContext = new (window.AudioContext || window.webkitAudioContext)();
          const analyser = audioContext.createAnalyser();
          analyser.fftSize = 256;
          analyser.connect(audioContext.destination);
      
          const bufferLength = analyser.frequencyBinCount;
          const dataArray = new Uint8Array(bufferLength);
      
          document.addEventListener('click', () => {
            if (backgroundMusic && audioContext && audioContext.state === 'suspended') {
              audioContext.resume().then(() => {
                const source = audioContext.createMediaElementSource(backgroundMusic);
                source.connect(analyser);
                backgroundMusic.play();
              });
            }
          }, { once: true });
      
          function visualizeAudio() {
            requestAnimationFrame(visualizeAudio);
            if (audioContext && audioContext.state === 'running') {
              analyser.getByteFrequencyData(dataArray);
              const average = Array.from(dataArray).reduce((a, b) => a + b, 0) / dataArray.length;
              const normalizedValue = average / 256;
      
              if (sun) {
                const basePulse = 1 + normalizedValue * 0.15;
                sun.scale.set(basePulse, basePulse, basePulse);
                if (sunLight) {
                  sunLight.intensity = 1.5 + normalizedValue;
                }
              }
            }
          }
      
          visualizeAudio();
        } catch (error) {
          console.error("Web Audio API not supported:", error);
        }
      }

      function addPositionalAudioToPlanets() {
        if (!audioListener) return;
      
        planets.forEach((planetGroup) => {
          const planet = planetGroup.children[0];
          if (planet) {
            try {
              const planetSound = new THREE.PositionalAudio(audioListener);
              planetSound.setRefDistance(20 + planetGroup.userData.size * 2);
              planetSound.setVolume(0.3);
      
              const oscillator = audioContext.createOscillator();
              const baseFrequency = 220;
              const planetRatio = 1 / planetGroup.userData.distance;
              oscillator.frequency.value = baseFrequency * planetRatio * 8;
      
              const gainNode = audioContext.createGain();
              gainNode.gain.value = 0.05;
      
              oscillator.connect(gainNode);
              planetSound.setNodeSource(gainNode);
      
              planet.add(planetSound);
              oscillator.start(0);
            } catch (error) {
              console.error(`Error adding sound to ${planet.name}:`, error);
            }
          }
        });
      }
    </script>
    <script>
      function goToHome() {
        window.location.href = "https://resumewebsite.glitch.me/"; // Navigate back to the homepage
      }
    </script>
  </body>
</html>
